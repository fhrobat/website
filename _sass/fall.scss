:root{
  --char-pop-duration: 180ms;    /* pop prima della caduta */
  --char-fall-duration: 1600ms;  /* durata caduta */
  --char-rise-duration: 900ms;   /* durata risalita */
  --char-pop-max-delay: 120;     /* max delay random prima del pop (ms) */
  --char-stagger: 18ms;
  --max-fall-y: 120vh;
  --shadow-start: 0 6px 12px rgba(0,0,0,0.06);
  --shadow-mid:   0 18px 36px rgba(0,0,0,0.12);
}

/* comportamento INIZIALE: inline per permettere giustificazione */
.fall-char {
  display: inline;           /* IMPORTANT: inline per consentire giustificazione */
  white-space: pre;          /* preserve spaces */
  will-change: transform, opacity, box-shadow;
  transform-origin: center;
  vertical-align: baseline;
  line-height: 1.1;         /* regola se vedi piccoli offset; metti 1 o quello del tuo testo */
}

/* ===== small pop (sbalzo) prima di cadere ===== */
@keyframes char-pop {
  0%   { transform: translateY(0) scale(1); }
  40%  { transform: translateY(-8px) scale(1.03); }
  100% { transform: translateY(0) scale(1); }
}
.char-pop {
  display: inline-block; /* ora diventa inline-block per poter trasformare */
  animation: char-pop var(--char-pop-duration) cubic-bezier(.2,.9,.3,1) forwards;
  vertical-align: baseline;
}

/* ===== CADUTA: trasla giù, ruota e aumenta ombra ===== */
@keyframes char-fall {
  0% {
    transform: translateY(0) rotate(0deg) scale(1);
    opacity: 1;
    box-shadow: var(--shadow-start);
  }
  60% {
    transform: translateY(calc(var(--max-fall-y) * 0.5)) rotate(calc(var(--r) * 0.6)) scale(0.99);
    opacity: 0.95;
    box-shadow: var(--shadow-mid);
  }
  100% {
    transform: translateY(var(--max-fall-y)) rotate(calc(var(--r) * 1.2)) scale(0.98);
    opacity: 0;
    box-shadow: 0 48px 80px rgba(0,0,0,0.18);
  }
}

.char-fall-active {
  display: inline-block; /* necessario per transform/rotate/translate */
  vertical-align: baseline;
  animation: char-fall var(--char-fall-duration) cubic-bezier(0.2,0.8,0.2,1) forwards;
}

/* ===== RISALITA con overshoot (rimbalzo) ===== */
@keyframes char-rise {
  0% {
    transform: translateY(var(--max-fall-y)) rotate(calc(var(--r) * 1.2)) scale(0.98);
    opacity: 0;
    box-shadow: 0 48px 80px rgba(0,0,0,0.18);
  }
  60% {
    transform: translateY(-12px) rotate(calc(var(--r) * 0.15)) scale(1.02);
    opacity: 1;
    box-shadow: var(--shadow-mid);
  }
  85% {
    transform: translateY(4px) rotate(0deg) scale(0.995);
    box-shadow: var(--shadow-start);
  }
  100% {
    transform: translateY(0) rotate(0deg) scale(1);
    opacity: 1;
    box-shadow: none;
  }
}

.char-rise-active {
  display: inline-block;
  vertical-align: baseline;
  animation: char-rise var(--char-rise-duration) cubic-bezier(0.2,1,0.3,1) forwards;
}

/* durante l'effetto blocca scroll e interazioni SOLO per la zona gravity-zone
   (evita di disabilitare click su tutto il sito) */
.falling-mode #gravity-zone,
.falling-mode #gravity-zone * {
  pointer-events: none;
  user-select: none;
}

/* se vuoi disabilitare globalmente (più drastico) usa la regola seguente al posto di sopra:
.falling-mode {
  overflow: hidden !important;
}
.falling-mode * { pointer-events: none; user-select: none; }
*/
