/* =========================
   Variabili
   ========================= */
$btn-bg: #f2f5f9;        // invece di bianco puro
$btn-hover: #e6edf6;     // hover più evidente
$btn-open-bg: #eef3fa;   // interno quando aperto
$btn-border: #c7d1de;    // bordo un filo più marcato
$btn-accent: #012a4a;

$radius: 10px;
$padding-summary: 0.55rem 0.85rem;
$padding-content: 0.9rem;
$transition-fast: 200ms ease;
$transition-slow: 300ms ease;

/* =========================
   Contenitore details = il "box"
   ========================= */
.boxed-toggle {
  border: 1px solid $btn-border;
  border-radius: $radius;
  background: $btn-bg;
  overflow: hidden;       /* importante: mantiene il contenuto dentro il box */
  transition: box-shadow $transition-fast, border-color $transition-fast, background $transition-fast;

  /* =========================
     Hover visibile e accessibile
     - il parent reagisce quando il summary è hoverato (via :has)
     - focus-within è attivo SOLO quando il box è CHIUSO (evita evidenziazione persistente dopo click)
     ========================= */
  &:has(.boxed-summary:hover),
  &:not([open]):focus-within {
    background: $btn-open-bg;                 /* leggero cambio visivo */
    box-shadow: 0 10px 26px rgba(1,42,74,0.06); /* un filo più evidente */
    border-color: rgba(1,42,74,0.14);
  }

  /* stato when open: più neutro, non troppo “evidenziato” (ma differente da closed) */
  &[open] {
    background: $btn-open-bg;
    border-color: rgba(1,42,74,0.12);
    box-shadow: 0 6px 18px rgba(1,42,74,0.04);
  }

  /* Se è open e l'utente poi ci passa sopra col mouse, mostriamo hover più evidente */
  &[open]:has(.boxed-summary:hover) {
    box-shadow: 0 10px 26px rgba(1,42,74,0.06);
  }

  /* =========================
     Summary (intestazione) – non ha bordo proprio
     ========================= */
  > .boxed-summary {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    gap: .5rem;
    width: 100%;

    /* sembra un bottone ma senza duplicare il bordo: padding esterno */
    padding: $padding-summary;
    margin: 0;                 /* summary ha margine 0 per non aggiungere spazi */
    background: transparent;
    color: $btn-accent;
    font-weight: 600;
    cursor: pointer;
    user-select: none;

    /* rimuovi marker nativo */
    &::-webkit-details-marker { display: none; }
    &::marker { content: none; }

    /* caret minimal */
    &::before {
      content: "";
      display:inline-block;
      width: 0.55em;
      height: 0.55em;
      margin-right: 0.45rem;
      border-right: 2px solid $btn-accent;
      border-bottom: 2px solid $btn-accent;
      transform: rotate(45deg);
      transition: transform $transition-fast;
    }

    /* Fallback e feedback immediato del summary (utile se :has non è disponibile) */
    &:hover {
      background: $btn-hover;
    }

    /* focus per tastiera (non rimuovere completamente l'indicatore accessibile) */
    &:focus-visible {
      outline: none;
      box-shadow: 0 0 0 4px rgba(1,42,74,0.06);
      background: $btn-hover;
    }
  }

  /* caret ruota quando open */
  &[open] > .boxed-summary::before {
    transform: rotate(135deg);
  }

  /* =========================
     Contenuto (dentro lo stesso box)
     ========================= */
  > .smooth-content {
    /* stato iniziale: chiuso */
    overflow: hidden;
    height: 0;
    padding: 0 $padding-content; /* manteniamo padding orizzontale sempre; verticale animiamo */
    opacity: 0;
    transition: height $transition-slow, opacity $transition-fast, padding $transition-fast;

    /* interno: quando visibile usa uno sfondo leggermente diverso (opzionale) */
    background: $btn-open-bg;

    /* contenuto vero: margini interni */
    & > * {
      margin: 0.6rem 0;
    }
  }

  /* quando aperto: JS imposterà height -> auto, e l'opacità è attivata */
  &[open] > .smooth-content {
    opacity: 1;
    padding-top: $padding-content;
    padding-bottom: $padding-content;
  }
}
